
from src.common import to_bytes, from_bytes
from src.logger import log

import usb
import array


def exploit(device, config, payload, arguments):

    def da_read(address, length, check_result = True):
        return da_read_write(0, address, length, None, check_result)

    def da_write(address, length, data, check_result = True):
        return da_read_write(1, address, length, data, check_result)

    def da_read_write(direction, address, length, data = None, check_result = True):
            try: